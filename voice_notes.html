<!DOCTYPE html>
<html>
<head>
  <title>Voice Notes</title>
</head>
<body>
  <h1>Voice Notes</h1>
  <button id="recordButton">Record</button>

  <script>
    let mediaRecorder;
    const chunks = [];

    function startRecording() {
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then((stream) => {
          mediaRecorder = new MediaRecorder(stream);
          mediaRecorder.addEventListener('dataavailable', handleDataAvailable);
          mediaRecorder.start();
          console.log('Recording started.');
        })
        .catch((error) => {
          console.error('Error accessing microphone:', error);
        });
    }

    function stopRecording() {
      if (mediaRecorder && mediaRecorder.state !== 'inactive') {
        mediaRecorder.stop();
        console.log('Recording stopped.');
      }
    }

    function handleDataAvailable(event) {
      if (event.data.size > 0) {
        chunks.push(event.data);
      }
    }

    function saveRecording() {
      if (chunks.length === 0) {
        console.log('No recording to save.');
        return;
      }

      const blob = new Blob(chunks, { type: 'audio/webm' });
      const url = URL.createObjectURL(blob);

      const audioElement = document.createElement('audio');
      audioElement.controls = true;
      audioElement.src = url;

      const recordingsContainer = document.getElementById('recordingsContainer');
      recordingsContainer.appendChild(audioElement);

      chunks.length = 0; // Clear the chunks array
    }

    document.getElementById('recordButton').addEventListener('click', () => {
      if (mediaRecorder && mediaRecorder.state === 'recording') {
        stopRecording();
      } else {
        startRecording();
      }
    });
  </script>
</body>
</html>
